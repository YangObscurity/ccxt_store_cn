# BT-CCXT-Store-CN é‡åŒ–äº¤æ˜“æ¡†æ¶

[English Version Below](#english-version)

## æ¦‚è¿°

æœ¬æ¡†æ¶æ˜¯åŸºäº **CCXT** å’Œ **Backtrader** æ„å»ºçš„åŠ å¯†è´§å¸é‡åŒ–äº¤æ˜“ç³»ç»Ÿï¼Œä¸“ä¸ºä¸­æ–‡å¼€å‘è€…ä¼˜åŒ–ã€‚æ”¯æŒä»æ•°æ®é‡‡é›†åˆ°ç­–ç•¥æ‰§è¡Œçš„å…¨æµç¨‹ç®¡ç†ï¼Œé’ˆå¯¹ä¸­å›½ç½‘ç»œç¯å¢ƒæ·±åº¦ä¼˜åŒ–ï¼Œæä¾›å®Œæ•´çš„é‡åŒ–è§£å†³æ–¹æ¡ˆã€‚

---

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### æ•°æ®ç®¡ç†
- ğŸ•’ **æ™ºèƒ½æ•°æ®åŒæ­¥**  
  æ”¯æŒ1åˆ†é’Ÿ/1å°æ—¶Kçº¿æ•°æ®è‡ªåŠ¨è¡¥å…¨ï¼Œè‡ªåŠ¨æ£€æµ‹æ—¶é—´æˆ³è¿ç»­æ€§
- ğŸ§© **ç¼ºå£ä¿®å¤ç³»ç»Ÿ**  
  å¤šå±‚çº§ç¼ºå£æ£€æµ‹ç®—æ³•ï¼Œæ”¯æŒå¤±è´¥é‡è¯•å’Œè¿›åº¦ä¿å­˜
- ğŸ›¡ï¸ **æ•°æ®å®Œæ•´æ€§ä¿éšœ**  
  è‡ªåŠ¨æ¸…ç†è¿‡æœŸæ•°æ®ï¼Œæ”¯æŒ30å¤©åˆ†é’Ÿçº¿/365å¤©å°æ—¶çº¿ä¿ç•™ç­–ç•¥

### äº¤æ˜“å¼•æ“
- âš¡ **å¤šäº¤æ˜“æ‰€ç»Ÿä¸€æ¥å£**  
  æ·±åº¦é€‚é…OKX/Binanceç­‰äº¤æ˜“æ‰€APIï¼Œä¼˜åŒ–ä¸­å›½ç½‘ç»œè¿æ¥
- ğŸ“ˆ **å®æ—¶ç›‘æ§ç³»ç»Ÿ**  
  å¼‚æ­¥æ•°æ®æ›´æ–°ï¼Œæ¯ç§’å¤„ç†1000+è¡Œæƒ…äº‹ä»¶
- ğŸ”„ **ç­–ç•¥çƒ­åŠ è½½**  
  æ”¯æŒè¿è¡Œæ—¶åŠ¨æ€æ›´æ–°ç­–ç•¥å‚æ•°

### ç­–ç•¥å¼€å‘
- ğŸ“Š **å†…ç½®æŒ‡æ ‡åº“**  
  é›†æˆRSI/MACD/å¸ƒæ—å¸¦ç­‰20+å¸¸ç”¨æŠ€æœ¯æŒ‡æ ‡
- ğŸ§  **æ™ºèƒ½ä¿¡å·å¼•æ“**  
  æ”¯æŒä¸‰é‡è¿‡æ»¤æœºåˆ¶ï¼ˆè¶‹åŠ¿çº¿+æ³¢åŠ¨ç‡+å­£èŠ‚æ€§å› å­ï¼‰
- ğŸ“‰ **å‚æ•°ä¼˜åŒ–å·¥å…·**  
  æä¾›é—ä¼ ç®—æ³•å’Œè’™ç‰¹å¡æ´›ä¼˜åŒ–æ¨¡å—

### å¯è§†åŒ–
- ğŸ“Š **äº¤äº’å¼ä»ªè¡¨æ¿**  
  å®æ—¶å±•ç¤ºèµ„é‡‘æ›²çº¿/æŒä»“åˆ†å¸ƒ/é£é™©æŒ‡æ ‡
- ğŸš¨ **é£é™©é¢„è­¦ç³»ç»Ÿ**  
  åŠ¨æ€å›æ’¤ç›‘æ§ä¸è‡ªåŠ¨ç†”æ–­æœºåˆ¶
- ğŸ“ˆ **å¤šç»´åº¦åˆ†æ**  
  æ”¯æŒç­–ç•¥æ”¶ç›Šå½’å› å’Œå‚æ•°æ•æ„Ÿæ€§åˆ†æ

---

## ğŸš€ å¿«é€Ÿå…¥é—¨

### ç¯å¢ƒè¦æ±‚
- Python 3.8+
- SQLite 3.35+
- CCXT 3.0+

### å®‰è£…æ­¥éª¤
```bash
# å…‹éš†ä»“åº“
git clone https://github.com/phonegapX/bt-ccxt-store-cn.git
cd bt-ccxt-store-cn

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# åˆå§‹åŒ–æ•°æ®åº“
mkdir -p data && sqlite3 data/tick.db ".read init.sql"
```
### é…ç½®è¯´æ˜ (params.json)
```
{
    "exchange": {  // äº¤æ˜“æ‰€é…ç½®
        "name": "okx",                // äº¤æ˜“æ‰€åç§° (æ”¯æŒokx/binanceç­‰)
        "apikey": "",     // APIè®¿é—®å¯†é’¥ï¼ˆéœ€ä»äº¤æ˜“æ‰€è·å–ï¼‰
        "secret": "",      // APIå¯†é’¥ç­¾åï¼ˆæ•æ„Ÿä¿¡æ¯ï¼Œéœ€åŠ å¯†å­˜å‚¨ï¼‰
        "password": "" // äº¤æ˜“å¯†ç ï¼ˆéƒ¨åˆ†äº¤æ˜“æ‰€éœ€è¦ï¼‰
    },
    "spot_symbols": [                 // ç›‘æ§çš„ç°è´§äº¤æ˜“å¯¹åˆ—è¡¨
        "BTC/USDT",                   // æ¯”ç‰¹å¸/æ³°è¾¾å¸
        "SOL/USDT",                   // Solana/æ³°è¾¾å¸
        "TRX/USDT",                   // TRON/æ³°è¾¾å¸ 
        "SUI/USDT",                   // Sui/æ³°è¾¾å¸
        "DOGE/USDT"                   // ç‹—ç‹—å¸/æ³°è¾¾å¸
    ],
    "gap_fill": {                     // æ•°æ®ç¼ºå£ä¿®å¤é…ç½®
        "enabled": true,              // å¯ç”¨ç¼ºå£è‡ªåŠ¨ä¿®å¤ï¼ˆtrue/falseï¼‰
        "max_retries": 5,             // å•æ¬¡ç¼ºå£æœ€å¤§é‡è¯•æ¬¡æ•°ï¼ˆ3-10ï¼‰
        "retry_delay": 10             // é‡è¯•é—´éš”æ—¶é—´ï¼ˆç§’ï¼Œå»ºè®®10-60ï¼‰
    },
    "historical_fill": {              // å†å²æ•°æ®è¡¥å…¨é…ç½®
        "enabled": false,             // å¯ç”¨å†å²æ•°æ®åŒæ­¥ï¼ˆtrue/falseï¼‰
        "initial_days": 365,          // åˆå§‹åŒ–è·å–å¤©æ•°ï¼ˆæœ€å¤§3å¹´ï¼‰
        "page_size": 2000             // åˆ†é¡µå¤§å°ï¼ˆ500-5000ï¼‰
    },
    "proxy": {                        // ç½‘ç»œä»£ç†é…ç½®ï¼ˆä¸­å›½ç”¨æˆ·å¿…å¡«ï¼‰
        "https": "http://ä½ çš„åœ°å€:ç«¯å£",  // HTTPSä»£ç†åœ°å€
        "http": "http://ä½ çš„åœ°å€:ç«¯å£"    // HTTPä»£ç†åœ°å€
    },
    "monitor": {                      // ç­–ç•¥ç›‘æ§å‚æ•°
        "rsi_period": 14,             // RSIè®¡ç®—å‘¨æœŸï¼ˆ7-21ï¼‰
        "ma_period": 200,             // ç§»åŠ¨å¹³å‡å‘¨æœŸï¼ˆ50-500ï¼‰
        "atr_period": 14,             // ATRæ³¢åŠ¨ç‡å‘¨æœŸï¼ˆ7-28ï¼‰
        "min_history_bars": XX,      // æœ€å°å†å²æ•°æ®é‡ï¼ˆå»ºè®®â‰¥ç­–ç•¥æœ€å¤§å‘¨æœŸï¼‰
        "oversold": XX,               // RSIè¶…å–é˜ˆå€¼ï¼ˆ0-30ï¼‰
        "overbought": XX              // RSIè¶…ä¹°é˜ˆå€¼ï¼ˆ70-100ï¼‰
    },
    "logging": {                      // æ—¥å¿—é…ç½®
        "debug": true,                // è°ƒè¯•æ¨¡å¼ï¼ˆè¯¦ç»†æ—¥å¿—ï¼Œç”Ÿäº§ç¯å¢ƒå»ºè®®falseï¼‰
        "log_api_requests": true      // è®°å½•å®Œæ•´APIè¯·æ±‚ï¼ˆå¯èƒ½åŒ…å«æ•æ„Ÿä¿¡æ¯ï¼‰
    },
    "data_retention": {               // æ•°æ®ä¿ç•™ç­–ç•¥
        "1m": XX,                     // åˆ†é’Ÿçº§æ•°æ®ä¿ç•™å¤©æ•°ï¼ˆ7-90ï¼‰
        "1h": XX                     // å°æ—¶çº§æ•°æ®ä¿ç•™å¤©æ•°ï¼ˆ90-730ï¼‰
    },
    "database_maintenance": {         // æ•°æ®åº“ç»´æŠ¤
        "interval_hours": XX           // ç»´æŠ¤é—´éš”ï¼ˆå°æ—¶ï¼Œå»ºè®®4-24ï¼‰
    },
    "sandbox": false,                 // æ²™ç›’æ¨¡å¼ï¼ˆæµ‹è¯•ç¯å¢ƒï¼‰
    "enable_visualization": false     // å¯ç”¨å¯è§†åŒ–ä»ªè¡¨æ¿ï¼ˆhttp://localhost:8050ï¼‰
}
```

## ä»£ç ç¤ºä¾‹
```python
from monitor import TradingMonitor
from strategies.enhanced_strategy import TrendFollowingStrategy

# åˆå§‹åŒ–äº¤æ˜“ç›‘æ§å™¨
monitor = TradingMonitor(
    strategy_class=TrendFollowingStrategy,
    config_path='params.json'
)

# å¯åŠ¨å®æ—¶äº¤æ˜“å¾ªç¯
monitor.run(
    enable_historical_fill=True,  # è‡ªåŠ¨è¡¥å…¨å†å²æ•°æ®
    enable_risk_control=True       # å¯ç”¨é£æ§æ¨¡å—
)
```
## ğŸ“Š å¯è§†åŒ–åŠŸèƒ½
### è®¿é—® ` http://localhost:8050 ` æŸ¥çœ‹å®æ—¶ä»ªè¡¨æ¿ï¼š

- å®æ—¶è¡Œæƒ…ï¼šå¤šå“ç§ä»·æ ¼èµ°åŠ¿å¯¹æ¯”

- ä»“ä½ç®¡ç†ï¼šåŠ¨æ€å±•ç¤ºèµ„äº§åˆ†å¸ƒ

- é£é™©æŒ‡æ ‡ï¼šå¤æ™®æ¯”ç‡/æœ€å¤§å›æ’¤å®æ—¶è®¡ç®—

- ä¿¡å·è¿½è¸ªï¼šä¹°å–ä¿¡å·æ ‡è®°ä¸å†å²å›æ”¾

## ğŸ”§ é«˜çº§åŠŸèƒ½
- å›æµ‹å¼•æ“
```python
from backtest_engine import Optimizer
# å¤šå‚æ•°ç©ºé—´ä¼˜åŒ–
optimizer = Optimizer(
    strategy=TrendFollowingStrategy,
    params_space={
        'ma_period': range(50, 301, 50),
        'rsi_period': [14, 21, 28]
    }
)
best_params = optimizer.run(
    initial_capital=100000,
    commission=0.001
)
```
### é£é™©ç®¡ç†
```python
from risk_manager import PortfolioOptimizer

# ç»„åˆä¼˜åŒ–
optimizer = PortfolioOptimizer()
weights = optimizer.calculate(
    symbols=["BTC/USDT", "ETH/USDT"],
    method='max_sharpe'  # æœ€å¤§å¤æ™®æ¯”ç‡ä¼˜åŒ–
)
```
## ğŸ“š å¼€å‘æŒ‡å—
### æ‰©å±•ç­–ç•¥
```python
class MyCustomStrategy(bt.Strategy):
    params = (
        ('custom_param', 30),
        ('volatility_window', 14)
    )

    def __init__(self):
        # ä½¿ç”¨å†…ç½®æŒ‡æ ‡è®¡ç®—å™¨
        self.volatility = self.indicators.ATR(period=self.p.volatility_window)
        
    def next(self):
        if self.volatility[0] > 0.1:
            self.order_target_percent(target=0.9)
```
### æ•°æ®æ¥å…¥
```python
from data_feeds import CustomDataFeed

# æ¥å…¥è‡ªå®šä¹‰æ•°æ®æº
feed = CustomDataFeed(
    symbol="BTC/USDT",
    timeframe="1h",
    start_date="2023-01-01"
)
```
---
<a id="english-version"></a>

# BT-CCXT-Store-CN Quantitative Trading Framework

## Overview

A professional-grade cryptocurrency quantitative trading framework built on **CCXT** and **Backtrader**, optimized for global developers with special enhancements for Chinese network environments. Provides end-to-end solutions from data acquisition to strategy execution.

---

## âœ¨ Core Features

### Data Management
- ğŸ•’ **Smart Data Synchronization**  
  Auto-completion of 1m/1h candlestick data with timestamp continuity validation
- ğŸ§© **Gap Repair System**  
  Multi-layer gap detection algorithm with retry logic and progress persistence
- ğŸ›¡ï¸ **Data Integrity Assurance**  
  Automatic data retention policies (30 days for 1m, 365 days for 1h data)

### Trading Engine
- âš¡ **Unified Exchange Interface**  
  Deep integration with OKX/Binance APIs, optimized for China network latency
- ğŸ“ˆ **Real-time Monitoring**  
  Asynchronous data processing (1000+ events/sec)
- ğŸ”„ **Hot-reload Strategies**  
  Dynamic parameter updates during runtime

### Strategy Development
- ğŸ“Š **Built-in Indicator Library**  
  20+ technical indicators including RSI, MACD, Bollinger Bands
- ğŸ§  **Smart Signal Engine**  
  Triple-layer filters (Trend + Volatility + Seasonality)
- ğŸ“‰ **Parameter Optimization**  
  Genetic Algorithm and Monte Carlo optimization modules

### Visualization
- ğŸ“Š **Interactive Dashboard**  
  Real-time equity curve/position distribution/risk metrics
- ğŸš¨ **Risk Alert System**  
  Dynamic drawdown monitoring with auto-circuit-breaker
- ğŸ“ˆ **Multi-dimensional Analysis**  
  Strategy attribution and parameter sensitivity analysis

---

## ğŸš€ Quick Start

### Requirements
- Python 3.8+
- SQLite 3.35+
- CCXT 3.0+

### Installation
```bash
# Clone repository
git clone https://github.com/phonegapX/bt-ccxt-store-cn.git
cd bt-ccxt-store-cn

# Install dependencies
pip install -r requirements.txt

# Initialize database
mkdir -p data && sqlite3 data/tick.db ".read init.sql"
```
## Configuration (params.json)
```
{
    "exchange": {  // Exchange Configuration
        "name": "okx",                // Exchange name (okx/binance supported)
        "apikey": "",     // API access key (from exchange)
        "secret": "",      // API secret (encrypt in production)
        "password": "" // Trading password (if required)
    },
    "spot_symbols": [                 // Monitoring spot pairs
        "BTC/USDT",                   // Bitcoin/Tether
        "SOL/USDT",                   // Solana/Tether
        "TRX/USDT",                   // TRON/Tether
        "SUI/USDT",                   // Sui/Tether
        "DOGE/USDT"                   // Dogecoin/Tether
    ],
    "gap_fill": {                     // Data gap repair settings
        "enabled": true,              // Enable auto gap filling (true/false)
        "max_retries": 5,             // Max retries per gap (3-10)
        "retry_delay": 10             // Retry interval in seconds (10-60)
    },
    "historical_fill": {              // Historical data sync
        "enabled": false,             // Enable historical sync (true/false)
        "initial_days": 365,          // Days to fetch (max 3 years)
        "page_size": 2000             // Pagination size (500-5000)
    },
    "proxy": {                        // Network proxy (required in China)
        "https": "http://YOURS:PORT",  // HTTPS proxy endpoint
        "http": "http://YOURS:PORT"    // HTTP proxy endpoint
    },
    "monitor": {                      // Strategy parameters
        "rsi_period": 14,             // RSI period (7-21)
        "ma_period": 200,             // Moving average period (50-500)
        "atr_period": 14,             // ATR volatility period (7-28)
        "min_history_bars": XX,      // Minimum historical bars (â‰¥ strategy period)
        "oversold": XX,               // RSI oversold threshold (0-30)
        "overbought": XX              // RSI overbought threshold (70-100)
    },
    "logging": {                      // Logging settings
        "debug": true,                // Debug mode (verbose logging)
        "log_api_requests": true      // Log full API requests (sensitive)
    },
    "data_retention": {               // Data retention policy
        "1m": XX,                     // Minute-level data (7-90 days)
        "1h": XX                     // Hour-level data (90-730 days)
    },
    "database_maintenance": {         // DB maintenance
        "interval_hours": XX           // Maintenance interval (4-24 hours)
    },
    "sandbox": false,                 // Sandbox mode (test environment)
    "enable_visualization": false     // Enable dashboard (http://localhost:8050)
}
```
## Code Example
```python
from monitor import TradingMonitor
from strategies.enhanced_strategy import TrendFollowingStrategy

# Initialize trading monitor
monitor = TradingMonitor(
    strategy_class=TrendFollowingStrategy,
    config_path='params.json'
)

# Start trading loop
monitor.run(
    enable_historical_fill=True,  # Auto-complete historical data
    enable_risk_control=True       # Enable risk management
)
```
## ğŸ“Š Visualization
### Access real-time dashboard at `http://localhost:8050`:

- Market Monitor: Multi-asset price comparison

- Position Management: Dynamic asset allocation display

- Risk Metrics: Sharpe Ratio/Max Drawdown calculators

- Signal Tracking: Historical trade signal replay

## ğŸ”§ Advanced Features
### Backtesting Engine
```python
from backtest_engine import Optimizer

# Multi-parameter optimization
optimizer = Optimizer(
    strategy=TrendFollowingStrategy,
    params_space={
        'ma_period': range(50, 301, 50),
        'rsi_period': [14, 21, 28]
    }
)
best_params = optimizer.run(
    initial_capital=100000,
    commission=0.001
)
```
### Risk Management
```python
from risk_manager import PortfolioOptimizer

# Portfolio optimization
optimizer = PortfolioOptimizer()
weights = optimizer.calculate(
    symbols=["BTC/USDT", "ETH/USDT"],
    method='max_sharpe'  # Sharpe Ratio optimization
)
```
## ğŸ“š Development Guide
### Custom Strategy
```python
class MyCustomStrategy(bt.Strategy):
    params = (
        ('custom_param', 30),
        ('volatility_window', 14)
    )

    def __init__(self):
        # Use built-in indicator calculator
        self.volatility = self.indicators.ATR(period=self.p.volatility_window)
        
    def next(self):
        if self.volatility[0] > 0.1:
            self.order_target_percent(target=0.9)
```
### Data Integration
```python
from data_feeds import CustomDataFeed

# Connect custom data source
feed = CustomDataFeed(
    symbol="BTC/USDT",
    timeframe="1h",
    start_date="2023-01-01"
)
```
License
MIT License
